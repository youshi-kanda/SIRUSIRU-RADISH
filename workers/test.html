<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIRUSIRU Radish API ãƒ†ã‚¹ãƒˆ</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 900px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
            border-bottom: 3px solid #4CAF50;
            padding-bottom: 10px;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-section h2 {
            color: #4CAF50;
            margin-top: 0;
        }
        button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        button:hover {
            background: #45a049;
        }
        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        .input-group {
            margin: 15px 0;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }
        pre {
            background: #f4f4f4;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            border-left: 4px solid #4CAF50;
        }
        .response {
            margin-top: 15px;
        }
        .loading {
            color: #666;
            font-style: italic;
        }
        .error {
            color: #d32f2f;
        }
        .success {
            color: #4CAF50;
        }
        .label {
            font-weight: bold;
            margin-bottom: 5px;
            color: #555;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª SIRUSIRU Radish AI Engine ãƒ†ã‚¹ãƒˆ</h1>
    
    <div class="test-section">
        <h2>1. ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯</h2>
        <button onclick="testHealth()">å®Ÿè¡Œ</button>
        <div id="health-response" class="response"></div>
    </div>

    <div class="test-section">
        <h2>2. ç—‡çŠ¶å…¥åŠ›ãƒ†ã‚¹ãƒˆï¼ˆç–¾ç—…å€™è£œ3ã¤æç¤ºï¼‰</h2>
        <div class="input-group">
            <div class="label">ç—‡çŠ¶ã‚’å…¥åŠ›:</div>
            <input type="text" id="symptom-input" placeholder="ä¾‹: èƒƒãŒç—›ã„ã€é ­ç—›ãŒã™ã‚‹" value="èƒƒãŒç—›ã„">
        </div>
        <button onclick="testSymptom()">é€ä¿¡</button>
        <div id="symptom-response" class="response"></div>
    </div>

    <div class="test-section">
        <h2>3. ç–¾ç—…åå…¥åŠ›ãƒ†ã‚¹ãƒˆï¼ˆå¼•å—åˆ¤å®šï¼‰</h2>
        <div class="input-group">
            <div class="label">ç–¾ç—…åã‚’å…¥åŠ›:</div>
            <input type="text" id="disease-input" placeholder="ä¾‹: èƒƒãŒã‚“ã€ç³–å°¿ç—…" value="èƒƒãŒã‚“">
        </div>
        <div class="input-group">
            <div class="label">ä¼šè©±IDï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰:</div>
            <input type="text" id="conversation-id" placeholder="ä¾‹: test_conv_001" value="">
        </div>
        <button onclick="testDisease()">é€ä¿¡</button>
        <div id="disease-response" class="response"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8787';

        async function testHealth() {
            const responseDiv = document.getElementById('health-response');
            responseDiv.innerHTML = '<p class="loading">å®Ÿè¡Œä¸­...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/api/health`);
                const data = await response.json();
                
                responseDiv.innerHTML = `
                    <p class="success">âœ… æˆåŠŸ (${response.status})</p>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                responseDiv.innerHTML = `
                    <p class="error">âŒ ã‚¨ãƒ©ãƒ¼</p>
                    <pre>${error.message}</pre>
                `;
            }
        }

        async function testSymptom() {
            const query = document.getElementById('symptom-input').value;
            const responseDiv = document.getElementById('symptom-response');
            
            if (!query) {
                alert('ç—‡çŠ¶ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            responseDiv.innerHTML = '<p class="loading">å®Ÿè¡Œä¸­...</p>';
            
            try {
                const response = await fetch(`${API_BASE}/api/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ query })
                });
                
                const data = await response.json();
                
                responseDiv.innerHTML = `
                    <p class="success">âœ… æˆåŠŸ (${response.status})</p>
                    <div class="label">ãƒ¬ã‚¹ãƒãƒ³ã‚¹:</div>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                responseDiv.innerHTML = `
                    <p class="error">âŒ ã‚¨ãƒ©ãƒ¼</p>
                    <pre>${error.message}</pre>
                `;
            }
        }

        async function testDisease() {
            const query = document.getElementById('disease-input').value;
            const conversationId = document.getElementById('conversation-id').value;
            const responseDiv = document.getElementById('disease-response');
            
            if (!query) {
                alert('ç–¾ç—…åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                return;
            }
            
            responseDiv.innerHTML = '<p class="loading">å®Ÿè¡Œä¸­...</p>';
            
            const body = { query };
            if (conversationId) {
                body.conversation_id = conversationId;
            }
            
            try {
                const response = await fetch(`${API_BASE}/api/chat`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(body)
                });
                
                const data = await response.json();
                
                responseDiv.innerHTML = `
                    <p class="success">âœ… æˆåŠŸ (${response.status})</p>
                    <div class="label">ãƒ¬ã‚¹ãƒãƒ³ã‚¹:</div>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                `;
            } catch (error) {
                responseDiv.innerHTML = `
                    <p class="error">âŒ ã‚¨ãƒ©ãƒ¼</p>
                    <pre>${error.message}</pre>
                `;
            }
        }
    </script>
</body>
</html>
